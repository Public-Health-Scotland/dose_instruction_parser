

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Developing the dose_instruction_parser package &mdash; dose_instruction_parser 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=46e60e98" />

  
    <link rel="shortcut icon" href="../_static/favicon_phs.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/phs-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="parsing_dis.html">Parsing dose instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="training_model.html">Training a new named entity recogniser model</a></li>
<li class="toctree-l1"><a class="reference internal" href="adapting_code.html">Adapting the code to similar tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/dose_instruction_parser/modules.html">dose_instruction_parser module reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">dose_instruction_parser</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Developing the <strong class="program">dose_instruction_parser</strong> package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/doc_pages/developing_di_parser.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="developing-the-dose-instruction-parser-package">
<span id="development"></span><h1>Developing the <strong class="program">dose_instruction_parser</strong> package<a class="headerlink" href="#developing-the-dose-instruction-parser-package" title="Link to this heading"></a></h1>
<p>If you find a bug or would like to request an enhancement to the code, please open
an issue on <a class="reference external" href="https://github.com/Public-Health-Scotland/dose_instruction_parser/issues">GitHub</a>. If you would like to contribute, please fork this repository
and open a pull request.</p>
<section id="improving-modifying-the-existing-rules">
<h2>Improving/modifying the existing rules<a class="headerlink" href="#improving-modifying-the-existing-rules" title="Link to this heading"></a></h2>
<p>To convert named entities to the desired structured output we take a rule-based approach. The infrastructure was based on the open source <a class="reference external" href="https://github.com/royashcenazi/parsigs">parsigs</a> package
for parsing dose instructions.</p>
<p>There are different modules in the <a class="reference internal" href="../modules/dose_instruction_parser/dose_instruction_parser.html#module-dose_instruction_parser" title="dose_instruction_parser"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dose_instruction_parser</span></code></a> package which deal with different entities. Some of the named entities (ROUTE, DRUG, STRENGTH) are not processed here because this
is information which is separately stored for prescriptions so we don’t need to extract it from the dose instructions. The <strong class="program">DIParser</strong> class in <a class="reference internal" href="../modules/dose_instruction_parser/dose_instruction_parser.html#module-dose_instruction_parser.parser" title="dose_instruction_parser.parser"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dose_instruction_parser.parser</span></code></a>
is the culmination of all the pre-processing, NER and rule-based post-processing.</p>
<section id="best-practice-workflow">
<h3>Best practice workflow<a class="headerlink" href="#best-practice-workflow" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Follow the <a class="reference internal" href="installation.html#installation"><span class="std std-ref">Installation</span></a> instructions for a development install</p></li>
<li><p>Checkout a new branch</p></li>
<li><p>Edit the contents of the <code class="file docutils literal notranslate"><span class="pre">dose_instructions_parser</span></code> folder</p></li>
<li><p>Check the outcome using <strong class="program">parse_dose_instructions</strong> on the command line, or by importing the local <a class="reference internal" href="../modules/dose_instruction_parser/dose_instruction_parser.html#module-dose_instruction_parser" title="dose_instruction_parser"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dose_instruction_parser</span></code></a> package and running from python</p></li>
<li><p>Add comments for other developers</p></li>
<li><p>Add docstrings for code users</p></li>
<li><p>Make sure you update any tests in <code class="file docutils literal notranslate"><span class="pre">parse_dose_instructions/dose_instruction_parser/tests</span></code></p></li>
<li><p>Consider updating the documentation</p></li>
<li><p>Commit and push changes to Github</p></li>
<li><p>Open a pull request for your branch</p></li>
<li><p>Review tests and code coverage from GitHub actions</p></li>
</ul>
</section>
<section id="tips-and-tricks">
<h3>Tips and tricks<a class="headerlink" href="#tips-and-tricks" title="Link to this heading"></a></h3>
<ul>
<li><p>Try using an IPython prompt to explore the code in its present state
(type <cite>ipython</cite> in the Terminal to bring up the prompt). Then for example
to test the <a class="reference internal" href="../modules/dose_instruction_parser/dose_instruction_parser.html#dose_instruction_parser.di_frequency.get_frequency_info" title="dose_instruction_parser.di_frequency.get_frequency_info"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dose_instruction_parser.di_frequency.get_frequency_info</span></code></a> function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dose_instruction_parser.di_frequency</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_frequency_info</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_frequency_info</span><span class="p">(</span><span class="s2">&quot;twice daily&quot;</span><span class="p">)</span>

<span class="go">(2.0, 2.0, &#39;Day&#39;)</span>
</pre></div>
</div>
</li>
<li><p>If you edit the code with a prompt still open you may need to reload the
relevant module in order to get the changes. You can use the <cite>reload</cite>
function from <cite>importlib</cite> to do this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">dose_instruction_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">parser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">DIParser</span><span class="p">(</span><span class="s2">&quot;en_edris9&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make some changes to the parser module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">DIParser</span><span class="p">(</span><span class="s2">&quot;en_edris9&quot;</span><span class="p">)</span> <span class="c1"># changes won&#39;t have loaded</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">importlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">reload</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reload</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">DIParser</span><span class="p">(</span><span class="s2">&quot;en_edris9&quot;</span><span class="p">)</span> <span class="c1"># changes will have loaded</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Rosalyn Pearson, Nathalie Thureau, Mark Macartney, John Reid, Johanna Jokio.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>