

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adapting the code to similar tasks &mdash; dose_instruction_parser 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=46e60e98" />

  
    <link rel="shortcut icon" href="../_static/favicon_phs.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dose_instruction_parser" href="../modules/dose_instruction_parser/modules.html" />
    <link rel="prev" title="Training a new named entity recogniser model" href="training_model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/phs-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="parsing_dis.html">Parsing dose instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="training_model.html">Training a new named entity recogniser model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Adapting the code to similar tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parsing-dose-instructions-for-specific-drugs-or-conditions">Parsing dose instructions for specific drugs or conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#extracting-different-structural-information">Extracting different structural information</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-application-to-medical-free-text-parsing">General application to medical free text parsing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/dose_instruction_parser/modules.html">dose_instruction_parser module reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">dose_instruction_parser</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Adapting the code to similar tasks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/doc_pages/adapting_code.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="training_model.html" class="btn btn-neutral float-left" title="Training a new named entity recogniser model" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../modules/dose_instruction_parser/modules.html" class="btn btn-neutral float-right" title="dose_instruction_parser" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="adapting-the-code-to-similar-tasks">
<span id="adapting-to-similar-tasks"></span><h1>Adapting the code to similar tasks<a class="headerlink" href="#adapting-the-code-to-similar-tasks" title="Link to this heading"></a></h1>
<p>The <strong class="program">en_edris9</strong> model and <strong class="program">dose_instruction_parser</strong> package have been tailored to the problem of parsing free text dose instructions from prescriptions.
However, the code can be used as a starting point to solve similar problems.</p>
<section id="parsing-dose-instructions-for-specific-drugs-or-conditions">
<h2>Parsing dose instructions for specific drugs or conditions<a class="headerlink" href="#parsing-dose-instructions-for-specific-drugs-or-conditions" title="Link to this heading"></a></h2>
<p>The <strong class="program">en_edris9</strong> model was trained on a balanced set of data covering the whole of national prescribing information. This makes the model a
good “all rounder” when it comes to performance. If you are interested in a specific subset of drugs or conditions, you should be able to boost
performance by further training the model on this subset of data. To do this, follow instructions in the <a class="reference internal" href="training_model.html#training-a-model"><span class="std std-ref">Training a new named entity recogniser model</span></a> section, taking care to:</p>
<p>1. Create training data for the types of dose instruction you are interested in
1. Install the <strong class="program">en_edris9</strong> model (if you don’t have access you can use <strong class="program">en_core_med7_lg</strong>, obtained following the instructions <a class="reference external" href="https://github.com/kormilitzin/med7">here</a>)
1. Modify <code class="file docutils literal notranslate"><span class="pre">model/config/config.cfg</span></code> to replace all instances of <strong class="program">en_core_med7_lg</strong> with <strong class="program">en_edris9</strong>
1. Evaluate the performance compared to <strong class="program">en_edris9</strong> and/or <strong class="program">en_core_med7_lg</strong>, using <code class="file docutils literal notranslate"><span class="pre">model/compare_models.py</span></code> as a guide alongside output from <code class="file docutils literal notranslate"><span class="pre">source</span> <span class="pre">model/evaluate_model.sh</span></code></p>
</section>
<section id="extracting-different-structural-information">
<h2>Extracting different structural information<a class="headerlink" href="#extracting-different-structural-information" title="Link to this heading"></a></h2>
<p>In <strong class="program">en_edris9</strong> there are nine named entities extracted, which give rise to the following structured fields:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>inputID</p></td>
<td><p>ID passed in with dose instruction for bookkeeping</p></td>
</tr>
<tr class="row-odd"><td><p>text</p></td>
<td><p>The original free text dose instruction (can be later removed)</p></td>
</tr>
<tr class="row-even"><td><p>form</p></td>
<td><p>The form of drug e.g. “tablet”, “patch”, “injection”</p></td>
</tr>
<tr class="row-odd"><td><p>dosageMin</p></td>
<td><p>The minimum dosage</p></td>
</tr>
<tr class="row-even"><td><p>dosageMax</p></td>
<td><p>The maximum dosage</p></td>
</tr>
<tr class="row-odd"><td><p>frequencyMin</p></td>
<td><p>The minimum frequency</p></td>
</tr>
<tr class="row-even"><td><p>frequencyMax</p></td>
<td><p>The maximum frequency</p></td>
</tr>
<tr class="row-odd"><td><p>frequencyType</p></td>
<td><p>The type of frequency for the dosage e.g. “Hour”, “Day”, “2 Week”</p></td>
</tr>
<tr class="row-even"><td><p>durationMin</p></td>
<td><p>The minimum duration of treatment</p></td>
</tr>
<tr class="row-odd"><td><p>durationMax</p></td>
<td><p>The maximum duration of treatment</p></td>
</tr>
<tr class="row-even"><td><p>durationType</p></td>
<td><p>The type of duration for dosage e.g. “Day”, “Week”</p></td>
</tr>
<tr class="row-odd"><td><p>asRequired</p></td>
<td><p>True/False: Whether to take as required / as needed</p></td>
</tr>
<tr class="row-even"><td><p>asDirected</p></td>
<td><p>True/False: Whether to take as directed</p></td>
</tr>
</tbody>
</table>
<p>Changing this output requires three main steps:</p>
<ol class="arabic simple">
<li><p>Create new training data tagged with all the named entities you are interested in. You can add new entities here e.g. “AS_REQUIRED” and “AS_DIRECTED” were new entities surplus to those in <strong class="program">en_med7</strong></p></li>
<li><p>Make sure that <code class="code docutils literal notranslate"><span class="pre">overwrite_ents</span> <span class="pre">=</span> <span class="pre">True</span></code> in the <code class="code docutils literal notranslate"><span class="pre">[components.ner]</span></code> section of <code class="file docutils literal notranslate"><span class="pre">model/config/config.cfg</span></code>, then train a new model following <a class="reference internal" href="training_model.html#training-a-model"><span class="std std-ref">Training a new named entity recogniser model</span></a></p></li>
<li><p>Modify <code class="file docutils literal notranslate"><span class="pre">dose_instruction_parser/dose_instruction_parser</span></code> code to process the new entities into the output you desire. This process is more or less involved depending on the complexity of the entities. You can use the existing entities as a guide.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that you should include training data which is fully representative of the data you
would like to use the model for. If you only train the model further on a certain type of example
it will begin to “forget” what it already knows i.e. get worse at extracting entities which
it could do before but is now not being trained on.</p>
</div>
</section>
<section id="general-application-to-medical-free-text-parsing">
<h2>General application to medical free text parsing<a class="headerlink" href="#general-application-to-medical-free-text-parsing" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this case it would be best to create a totally new repository using this
repository as a starting point</p>
</div>
<p>This is a more involved version of the above. Broadly, you will need to</p>
<ol class="arabic simple">
<li><p>Create tagged training data with all the named entities you are interested in</p></li>
<li><p>Train a model following <a class="reference internal" href="training_model.html#training-a-model"><span class="std std-ref">Training a new named entity recogniser model</span></a></p></li>
<li><p>Heavily alter the <code class="file docutils literal notranslate"><span class="pre">dose_instruction_parser/dose_instruction_parser</span></code> code to process the output in the way you want.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="training_model.html" class="btn btn-neutral float-left" title="Training a new named entity recogniser model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../modules/dose_instruction_parser/modules.html" class="btn btn-neutral float-right" title="dose_instruction_parser" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Rosalyn Pearson, Nathalie Thureau, Mark Macartney, John Reid, Johanna Jokio.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>